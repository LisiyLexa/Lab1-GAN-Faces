# Создание генеративно-состязательных сетей (GAN) для создания изображений лиц

## Введение

В данном проекте рассматривется создание генеративно-состязательной сети (GAN) для генерации изображений лиц. Сеть разработана с использованием TensorFlow и Keras. В проекте предоставлены инструкции по использованию, а также изображения, демонстрирующие качество генерации.

<a target="_blank" href="https://colab.research.google.com/github/LisiyLexa/Lab1-GAN-Faces/blob/main/gan.ipynb">
  <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
</a>

## Запуск кода

### Требуемые библиотеки
- tensorflow
- keras
- numpy
- PIL
- matplotlib

### Запуск готовых моделей
В репозитории содержатся обученные мной модели на 50, 100 и 300 эпохах. Скачайте одну из них.

Для запуска достаточно запустить код ниже
```python
import tensorflow as tf
from tensorflow.keras.models import load_model
import matplotlib.pyplot as plt

generator = load_model("путь/к_файлу/модели.h5")
noise = tf.random.normal([1, 100])
generated_image = generator.predict(noise)

plt.imshow(generated_image[0, :, :, :] * 0.5 + 0.5)
```
### Запуск обучения на своих изображениях
**Учтите, что для более быстрого обучения нужно использовать видеокарту**

Если вы хотите обучить модель на своем датасете, то вам нужно:
1. Открыть файл **gan.ipynb** в удобной для вас среде.
2. Указать нужные настройки в данном блоке
![image](https://github.com/LisiyLexa/Lab1-GAN-Faces/assets/81087786/54acfcf6-c868-40f4-b0a3-f64cdeac7769)
3. Указть в переменной `faces_path` путь к папке с вашими изображениями
![image](https://github.com/LisiyLexa/Lab1-GAN-Faces/assets/81087786/78f72dbe-15a0-4763-add7-0795878381da)
4. Запустить все блоки по порядку

В конце вы увидите результат обучения. Ваша модель будет сохранена в файл `face_generator.h5`. В папке `output` будут сгенерированные изображения для каждой эпохи обучения.

## Набор данных

Для обучения использовался набор данных [faces_data_new](https://www.kaggle.com/datasets/gasgallo/faces-data-new). Размер: 7864 изображений.

## Обучение

Перед началом обучения нужно преобразовать изображения из нашего набора данных:

1. Масштабируем каждое изображение выборки. Оно должно быть квадратным.
2. Оставляем только 1 канал цвета(градации серого).
3. "Выпрямляем" изображение в вектор.
4. Сохраняем полученные векторы.

Далее модель обучается на этих векторах.

## Результаты работы

После обучения мы получаем примерно следующие результаты

### При 50 эпохах обучения
![train-50](https://github.com/LisiyLexa/Lab1-GAN-Faces/assets/81087786/377f048d-8123-42f3-847c-7de5136b330b)

### При 100 эпохах
![train-100](https://github.com/LisiyLexa/Lab1-GAN-Faces/assets/81087786/e92c1517-24cd-486d-a586-efd97b8e93a6)

### При 300 эпохах
![train-300](https://github.com/LisiyLexa/Lab1-GAN-Faces/assets/81087786/1a4842db-a1f2-4aeb-b5db-5711caf631ae)


## Проблемы и улучшения
В целом, изображения получаются довольно неплохими. Думаю, для "самопальной" модели такой результат можно считать успехом.

Для улучшения результата предлагаю поигаться с архитектурой модели, настройками функции потерь/оптимизаторов, использовоать другой датасет или увеличить длительность обучения. 
